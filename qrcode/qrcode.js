(function(){var a="";a+='	<div class="bookmark-qrcode">';a+='		<div id="bookmark-qrcode-img" class="img"></div>';a+='		<div class="input">';a+='			<textarea id="bookmark-qrcode-input"></textarea>';a+='			<button class="create" type="button" id="bookmark-qrcode-create">生成二维码</button> <button class="close" type="button" id="bookmark-qrcode-close">关闭</button>';a+='			<p><a href="http://ma.taobao.com/">http://ma.taobao.com/</a></p>';a+="		</div>";a+="	</div>",CSS=".bookmark-qrcode *{margin:0;padding:0;}.bookmark-qrcode{position:absolute;width:400px;background:#fff;border:8px solid #ffc40d;}.bookmark-qrcode .img,.bookmark-qrcode .input{float:left;padding:10px;}.bookmark-qrcode .img{width:180px;height:180px;}.bookmark-qrcode .img img{display:block;width:180px;height:180px;}.bookmark-qrcode .input{width:180px;height:200px;background:#ffc40d;padding:0 10px;}.bookmark-qrcode .input textarea{width:175px;height:120px;padding:5px;}.bookmark-qrcode .input button{padding:5px 10px;}.bookmark-qrcode .input a{display:block;font-size:12px;font-family:Arial,sans-serif;margin-top:10px;color:#fff;}",addStyleSheet=function(c,e){var d;if(e&&(e=e.replace("#",""))){d=document.getElementById("#"+e)}if(d){return}d=document.createElement("style");d.id=e;var b=document.getElementsByTagName("head")[0];b.appendChild(d);if(d.styleSheet){d.styleSheet.cssText=c}else{d.appendChild(document.createTextNode(c))}},get=function(b){return document.getElementById(b)},create=function(b){var c=document.createElement("div");c.innerHTML=b;document.body.appendChild(c);return c};container=create(a),textarea=get("bookmark-qrcode-input"),URL="http://ma.taobao.com/api/qrcode.html?activity=encode&text={text}&width=180&height=180&ecLevel=L&characterSet=gbk&t={t}",imgpanel=get("bookmark-qrcode-img"),createQR=function(d){var c=URL.replace("{text}",encodeURI(d)).replace("{t}",Math.random()),b=document.createElement("img");imgpanel.innerHTML="";b.src=c;imgpanel.appendChild(b)};addStyleSheet(CSS,"bookmark-qrcode");createQR(location.href);textarea.value=location.href;get("bookmark-qrcode-create").onclick=function(){createQR(textarea.value)};get("bookmark-qrcode-close").onclick=function(){document.body.removeChild(container)}})();